SELECT
    ARTIST,
    RELEASE_DATE,
    SUM(SPOTIFY_STREAMS) AS spotify_streams,
    SUM(YOU_TUBE_VIEWS) AS youtube_views,
    SUM(TIK_TOK_VIEWS) AS tiktok_views,
    SUM(PANDORA_STREAMS) AS pandora_streams
FROM {{ source('raw', 'MUSIC_TRACK_METRICS') }}
WHERE
    SPOTIFY_STREAMS IS NOT NULL
    AND YOU_TUBE_VIEWS IS NOT NULL
    AND TIK_TOK_VIEWS IS NOT NULL
    AND PANDORA_STREAMS IS NOT NULL
GROUP BY ARTIST, RELEASE_DATE
ORDER BY ARTIST, RELEASE_DATE
